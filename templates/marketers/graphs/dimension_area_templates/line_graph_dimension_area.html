<script>
    function convertToTextField(drop_down_id){
        var all_values = $.map($('#' + drop_down_id + ' select option') ,function(option) {return option;});
        var sel_value = $('#' + drop_down_id + ' select :selected');
        $('#' + drop_down_id + ' select').remove();
        $('#' + drop_down_id).append('<label>' + sel_value.text() + '</label>');
        return $.map(all_values, function(option){
                if(sel_value.val() != option.value)
                    return option;
              });
    }

    function loadSecondaryDimension(){
        var sel_value = $('#primary_dimensions select :selected').val();
        $('#dimension_vals_' + sel_value).remove();
        var all_values = convertToTextField('primary_dimensions');
        for(var val in all_values){
            var curr_val = all_values[val].value;
            var curr_text = all_values[val].text;
            if(curr_text == 0)
                curr_text = '--SELECT--';
            $('#secondary_dimensions select').append("<option value='" + curr_val + "'>" + curr_text + "</option>");
        }
    }

    function loadFilterValues(){
        var sel_value = $('#secondary_dimensions select :selected').val();
        $('#filters_container div').each(function(idx, div){
            var retDiv = $('#' + div.id).remove();
            if(div.id == 'dimension_vals_' + sel_value){
                $('#secondary_dimension_values').show();
                $('#secondary_dimension_values #secondary_dimension_values_container').append(retDiv[0]);
                $('#secondary_dimension_values #secondary_dimension_values_container #' + retDiv[0].id).show();
            }
            else{
                $('#filter_values').show();
                $('#filter_values #filter_values_container').append(retDiv[0]);
                $('#filter_values #filter_values_container #' + retDiv[0].id).show();
            }
        });
        convertToTextField('secondary_dimensions');
    }
</script>
<div>
    <p>Choose primary X parameter</p>
    <div id="primary_dimensions">
        <select class="options-list" onchange="loadSecondaryDimension()">
            <option value="">--SELECT--</option>
            {% for x_candidate in  x_candidates %}
                <option value="{{x_candidate.0}}">{{x_candidate.1}}</option>
            {%endfor%}
        </select>
    </div>
    <p>Choose secondary X parameter</p>
    <div id="secondary_dimensions">
        <select class="options-list" onchange="loadFilterValues()">
        </select>
    </div>
    <div id="secondary_dimension_values" style="display:none">
        <p>Pick a value for chosen secondary dimension</p>
        <div id="secondary_dimension_values_container">

        </div>
    </div>
    <div id="filter_values" style="display:none">
        <p>Choose filters:</p>
        <div id="filter_values_container">

        </div>
    </div>
    <div id="filters_container">
        {% for dimension, values in dimension_vals.items %}
            <div id="dimension_vals_{{dimension.0}}" style="display:none">
                <p>{{ dimension.1 }}</p>
                {% for val in values %}
                    <input type="checkbox" name="{{val}}" value="{{val}}" checked>{{val}}<br>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
</div>